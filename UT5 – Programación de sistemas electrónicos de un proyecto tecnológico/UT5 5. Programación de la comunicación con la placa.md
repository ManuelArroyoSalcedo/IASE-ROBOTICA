# UT5 – Programación de sistemas/circuitos electrónicos de un proyecto tecnológico

---

## Índice de contenidos

1. Conceptos básicos de microcontroladores
2. Uso del entorno de programación de sistemas electrónicos
3. Estructura de un programa para sistemas electrónicos
4. Fundamentos del lenguaje de programación
5. **Programación de la comunicación con la placa**
6. Análisis del funcionamiento de programas de sistemas electrónicos

---

## 5. Programación de la comunicación con la placa

Una vez conocidos los fundamentos del lenguaje de programación y la estructura de un programa para sistemas electrónicos, el siguiente paso consiste en **comunicarse con la placa**.

La comunicación entre el programa y el sistema electrónico se realiza mediante los **pines de entrada y salida** del microcontrolador, que permiten leer y generar señales eléctricas.

---

### Índice del apartado

1. [Los pines de la placa](#51-los-pines-de-la-placa)  
2. [Configuración de pines: entrada y salida](#52-configuración-de-pines-entrada-y-salida)  
3. [Escritura de señales digitales](#53-escritura-de-señales-digitales)  
4. [Lectura de señales digitales](#54-lectura-de-señales-digitales)  
5. [Uso de la información leída](#55-uso-de-la-información-leída)  
6. [Lectura de señales analógicas](#56-lectura-de-señales-analógicas)  
7. [Escritura de señales analógicas (PWM)](#57-escritura-de-señales-analógicas-pwm)  
8. [Envío de señales de control](#58-envío-de-señales-de-control)  
9. [Importancia de la correcta comunicación con la placa](#59-importancia-de-la-correcta-comunicación-con-la-placa)

[Anexo. Funciones básicas de comunicación con la placa](#Anexo-Funciones-básicas-de-comunicación-con-la-placa)

---

### 5.1. Los pines de la placa

La placa dispone de un conjunto de **pines** que permiten la conexión con elementos externos.

Desde el punto de vista del programa, los pines son identificados mediante un **número** y pueden configurarse para realizar distintas funciones.

Antes de utilizar un pin, es necesario indicar al sistema **cómo se va a usar**.

### 5.2. Configuración de pines: entrada y salida

Para poder utilizar un pin, debe configurarse previamente como **entrada** o como **salida**.

Esta configuración se realiza normalmente en la fase de inicialización del programa.

Ejemplo de configuración de pines:

```cpp
void setup() {
  pinMode(2, INPUT);   // Pin 2 configurado como entrada
  pinMode(13, OUTPUT); // Pin 13 configurado como salida
}
```

- Un pin configurado como **entrada** permite leer señales.
- Un pin configurado como **salida** permite enviar señales.

### 5.3. Escritura de señales digitales

Cuando un pin está configurado como salida, el programa puede **enviar una señal digital** a dicho pin.

Una señal digital solo puede tener dos estados:

- Nivel bajo (`LOW`)
- Nivel alto (`HIGH`)

Ejemplo de escritura de una señal digital:

```cpp

void loop() {
  digitalWrite(13, HIGH); // Activa la salida
}
```

Esta instrucción mantiene el pin en nivel alto mientras se ejecuta el programa.

### 5.4. Lectura de señales digitales

Cuando un pin está configurado como entrada, el programa puede **leer el estado de la señal** presente en ese pin.

El valor leído será:

- `LOW` si la señal está en nivel bajo.
- `HIGH` si la señal está en nivel alto.

Ejemplo de lectura de una señal digital:

```cpp

void loop() {
  int estado = digitalRead(2);
}
```

El valor leído puede almacenarse en una variable para su posterior uso.

### 5.5. Uso de la información leída

Las señales leídas a través de los pines de entrada permiten al programa **tomar decisiones**.

Por ejemplo, se puede activar una salida en función del estado de una entrada.

Ejemplo básico:

```cpp

void loop() {
  int estado = digitalRead(2);

  if (estado == HIGH) {
    digitalWrite(13, HIGH);
  } else {
    digitalWrite(13, LOW);
  }
}
```

En este caso, la salida depende directamente del estado de la entrada.

### 5.6. Lectura de señales analógicas

Además de señales digitales, algunos pines permiten trabajar con **señales analógicas**, cuyos valores pueden variar dentro de un rango.

Estas señales representan magnitudes variables, como:

- Intensidad de luz.
- Temperatura.
- Posición.

La **lectura de señales analógicas** devuelve un valor numérico proporcional a la señal recibida.

Ejemplo de lectura analógica:

```cpp

void loop() {
  int valor = analogRead(A0);
}
```

El valor obtenido es proporcional a la señal recibida y puede utilizarse posteriormente en el programa para tomar decisiones.

### 5.7. Escritura de señales analógicas (PWM)

Además de la escritura digital, algunas placas permiten generar **señales de control de tipo analógico** en determinados pines.

Este tipo de escritura **no genera una señal analógica real**, sino una señal digital
que se activa y desactiva muy rápidamente. Variando el tiempo que la señal permanece
activada, se puede simular un comportamiento analógico.  
Este mecanismo se denomina **PWM (Pulse Width Modulation)**.

La escritura de señales analógicas se realiza mediante la función `analogWrite()`.

**Sintaxis de `analogWrite()`**

La instrucción `analogWrite()` se utiliza para escribir una señal de control de tipo analógico (PWM) en un pin de salida.

```cpp
analogWrite(pin, valor);
```

- **`pin`**:
   Pin de salida que admite PWM.
- **`valor`**:
   Nivel de activación de la señal, comprendido entre **0 y 255**.
  - `0` → salida apagada
  - `255` → salida completamente activada
  - Valores intermedios → activación parcial

La señal generada no es analógica real, sino una señal digital modulada mediante **PWM**.

Ejemplo de escritura analógica:

```cpp
void loop() {
  analogWrite(9, 128);
}
```

En este ejemplo, el valor enviado no representa una tensión directa, sino un nivel
 medio de activación de la salida.

La escritura de señales analógicas mediante PWM se utiliza habitualmente para:

- Regular la intensidad de un LED.
- Controlar la velocidad de un motor.
- Ajustar el comportamiento de actuadores.

La combinación de lectura analógica y escritura analógica permite implementar
 sistemas electrónicos con control proporcional.

### 5.8. Envío de señales de control

La comunicación con la placa permite no solo leer información, sino también **controlar el comportamiento del sistema** mediante señales de salida.

El envío de señales de control se realiza mediante la escritura de señales digitales
en los pines de salida correspondientes, permitiendo activar o desactivar dispositivos
desde el programa.

Estas señales pueden:

- Activar o desactivar dispositivos.
- Controlar estados.
- Regular comportamientos mediante el programa.

La combinación de lectura de entradas y escritura de salidas permite implementar sistemas electrónicos interactivos.

### 5.9. Importancia de la correcta comunicación con la placa

La programación de la comunicación con la placa es fundamental para:

- Garantizar el correcto funcionamiento del sistema.
- Evitar comportamientos inesperados.
- Proteger los elementos electrónicos conectados.
- Desarrollar proyectos fiables y controlados.

En los siguientes apartados se analizará el funcionamiento de los programas desarrollados y su relación con el comportamiento del sistema electrónico.

### Anexo. Funciones básicas de comunicación con la placa

En la programación de sistemas electrónicos con Arduino se utilizan diversas funciones para configurar pines, leer señales y enviar señales de control.

A continuación se resumen las funciones más utilizadas.

#### `pinMode()`

Configura el modo de funcionamiento de un pin.

```cpp
pinMode(pin, modo);
```

- **`pin`**: número o identificador del pin.
- **`modo`**: `INPUT`, `OUTPUT` o `INPUT_PULLUP`.

#### `digitalWrite()`

Escribe una señal digital en un pin de salida.

```cpp
digitalWrite(pin, valor);
```

- **`pin`**: pin configurado como salida.
- **`valor`**: `HIGH` o `LOW`.

Se utiliza para activar o desactivar dispositivos.

#### `digitalRead()`

Lee el estado de un pin digital configurado como entrada.

```cpp
valor = digitalRead(pin);
```

- Devuelve `HIGH` o `LOW`.

Se utiliza para leer pulsadores, interruptores y sensores digitales.

#### `analogRead()`

Lee una señal analógica aplicada a un pin analógico.

```cpp
valor = analogRead(pin);
```

- **`pin`**: pin analógico (`A0`, `A1`, etc.).
- Devuelve un valor numérico proporcional a la señal recibida.

Se utiliza para leer sensores analógicos.

#### `analogWrite()`

Escribe una señal de control de tipo analógico mediante PWM.

```cpp
analogWrite(pin, valor);
```

- **`pin`**: pin de salida que admite PWM.
- **`valor`**: entero entre `0` y `255`.

Se utiliza para regular el comportamiento de actuadores.

#### `delay()`

Detiene la ejecución del programa durante un tiempo determinado.

```cpp
delay(tiempo);
```

- **`tiempo`**: duración en milisegundos.

Se utiliza para introducir pausas en la ejecución.

#### `Serial.begin()`

Inicia la comunicación por el puerto serie.

```cpp
Serial.begin(velocidad);
```

- **`velocidad`**: tasa de comunicación en baudios (por ejemplo, `9600`).

#### `Serial.println()`

Envía información por el puerto serie.

```cpp
Serial.println(dato);
```

Se utiliza para mostrar valores y mensajes durante la ejecución del programa.
